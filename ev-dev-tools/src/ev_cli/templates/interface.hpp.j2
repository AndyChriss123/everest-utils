{% from "helper_macros.j2" import print_spdx_line, result_type, cpp_type, var_to_cpp, call_cmd_signature, publish_var_signature %}
{{ print_spdx_line('Apache-2.0') }}
#ifndef {{ info.hpp_guard }}
#define {{ info.hpp_guard }}

#include <everest/utils/interface_defs.hpp>

namespace everest::interface::{{ info.interface }} {

{% if vars %}
struct Subscribes {
    Subscribes(Everest* ev, const Requirement& req) : _ev(ev), _req(req){};
    {% for var in vars %}
    void {{ var.name }}(const std::function<void({% if var.json_type != 'null' %}{{ cpp_type(var) }}{% endif %})>& listener);
    {% endfor %}

private:
    Everest* _ev;
    Requirement _req;
};
{% endif %}

{% if cmds %}
struct Calls {
    Calls(Everest* ev, const Requirement& req) : _ev(ev), _req(req){};
    {% for cmd in cmds %}
    {{ call_cmd_signature(cmd) }};
    {% endfor %}

private:
    Everest* _ev;
    Requirement _req;
};
{% endif %}

struct BootProvides {
    BootProvides(Everest* ev, const Requirement& req, const std::string& module_id);
    {% if vars %}Subscribes subscribe;{% endif %}
    std::string module_id;
};

struct RunProvides {
    RunProvides(Everest* ev, const Requirement& req, const std::string& module_id);
    {% if vars %}Subscribes subscribe;{% endif %}
    {% if cmds %}Calls call;{% endif %}
    std::string module_id;
};
}

#endif // {{ info.hpp_guard }}
